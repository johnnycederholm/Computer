- name: Ensure apt is usable
  ansible.builtin.apt:
    update_cache: true
    cache_valid_time: 3600

- name: Ensure sudo is installed
  ansible.builtin.apt:
    name: sudo
    state: present

- name: Set hostname
  ansible.builtin.hostname:
    name: "{{ bootstrap_hostname }}"
  when: bootstrap_hostname is defined

- name: Set timezone
  community.general.timezone:
    name: "{{ bootstrap_timezone }}"
  when: bootstrap_timezone is defined

- name: "Install common packages"
  ansible.builtin.apt:
    state: present
    name: "{{ bootstrap_packages }}"
  when:
    - bootstrap_packages | length > 0

- name: Install firewall
  ansible.builtin.include_tasks: firewall.yml
  when: bootstrap_firewall | bool

- name: Install Oh my posh
  ansible.builtin.include_tasks: ohmyposh.yml
  when: bootstrap_ohmyposh | bool
